/**
  * SiteWhere IDE Common Library v3.0.0-alpha.1
  * (c) 2019 SiteWhere LLC
  * @license CPAL-1.0
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("moment")):"function"==typeof define&&define.amd?define(["exports","vue","moment"],t):t((e=e||self).SiteWhereIdeCommon={},e.Vue,e.moment)}(this,function(e,d,t){"use strict";function n(e){console.log(e)}function r(e){return e?t(e).format("YYYY-MM-DD H:mm:ss"):"N/A"}function o(e,t){var r=e.$store.getters.selectedTenant;if(r){var o="/tenants/"+r.token+t;console.log("route to",o),e.$router.push(o)}else console.log("tenant was not set")}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(r,o,n){(n?Reflect.getOwnMetadataKeys(o,n):Reflect.getOwnMetadataKeys(o)).forEach(function(e){var t=n?Reflect.getOwnMetadata(e,o,n):Reflect.getOwnMetadata(e,o);n?Reflect.defineMetadata(e,t,r,n):Reflect.defineMetadata(e,t,r)})}d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var g={__proto__:[]}instanceof Array;function a(n){return function(e,t,r){var o="function"==typeof e?e:e.constructor;o.__decorators__||(o.__decorators__=[]),"number"!=typeof r&&(r=void 0),o.__decorators__.push(function(e){return n(e,t,r)})}}var v=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function s(e,t){var r=1<arguments.length&&void 0!==t?t:{};r.name=r.name||e._componentTag||e.name;var i=e.prototype;Object.getOwnPropertyNames(i).forEach(function(o){if("constructor"!==o)if(-1<v.indexOf(o))r[o]=i[o];else{var n=Object.getOwnPropertyDescriptor(i,o);void 0!==n.value?"function"==typeof n.value?(r.methods||(r.methods={}))[o]=n.value:(r.mixins||(r.mixins=[])).push({data:function(){return e={},t=o,r=n.value,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e;var e,t,r}}):(n.get||n.set)&&((r.computed||(r.computed={}))[o]={get:n.get,set:n.set})}}),(r.mixins||(r.mixins=[])).push({data:function(){return function(o,e){var t=e.prototype._init;e.prototype._init=function(){var e=this,t=Object.getOwnPropertyNames(o);if(o.$options.props)for(var r in o.$options.props)o.hasOwnProperty(r)||t.push(r);t.forEach(function(t){"_"!==t.charAt(0)&&Object.defineProperty(e,t,{get:function(){return o[t]},set:function(e){o[t]=e},configurable:!0})})};var r=new e;e.prototype._init=t;var n={};return Object.keys(r).forEach(function(e){void 0!==r[e]&&(n[e]=r[e])}),n}(this,e)}});var o=e.__decorators__;o&&(o.forEach(function(e){return e(r)}),delete e.__decorators__);var a,s,c,n,u,p=Object.getPrototypeOf(e.prototype),l=p instanceof d?p.constructor:d,f=l.extend(r);return a=f,s=e,c=l,Object.getOwnPropertyNames(s).forEach(function(e){if(!m[e]){var t=Object.getOwnPropertyDescriptor(a,e);if(!t||t.configurable){var r,o,n=Object.getOwnPropertyDescriptor(s,e);if(!g){if("cid"===e)return;var i=Object.getOwnPropertyDescriptor(c,e);if(r=n.value,o=h(r),null!=r&&("object"===o||"function"===o)&&i&&i.value===n.value)return}Object.defineProperty(a,e,n)}}}),"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys&&(y(n=f,u=e),Object.getOwnPropertyNames(u.prototype).forEach(function(e){y(n.prototype,u.prototype,e)}),Object.getOwnPropertyNames(u).forEach(function(e){y(n,u,e)})),f}var m={prototype:!0,arguments:!0,callee:!0,caller:!0};function c(t){return"function"==typeof t?s(t):function(e){return s(e,t)}}c.registerHooks=function(e){v.push.apply(v,i(e))};var u="__reactiveInject__";function p(i){var a=function(){var t=this,r="function"==typeof i?i.call(this):i;for(var e in(r=Object.create(r||null))[u]=this[u]||{},a.managed)r[a.managed[e]]=this[e];function o(e){r[a.managedReactive[e]]=n[e],Object.defineProperty(r[u],a.managedReactive[e],{enumerable:!0,get:function(){return t[e]}})}var n=this;for(var e in a.managedReactive)o(e);return r};return a.managed={},a.managedReactive={},a}var l="undefined"!=typeof Reflect&&void 0!==Reflect.getMetadata;function f(e,t,r){l&&(Array.isArray(e)||"function"==typeof e||void 0!==e.type||(e.type=Reflect.getMetadata("design:type",t,r)))}function b(r){return void 0===r&&(r={}),function(e,t){f(r,e,t),a(function(e,t){(e.props||(e.props={}))[t]=r})(e,t)}}var w=/\B([A-Z])/g;var x,O,D=(x=function(e,t){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}x(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),R=function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(a=(i<3?n(a):3<i?n(t,r,a):n(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a},_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},j=function(e,a,s,c){return new(s=s||Promise)(function(r,t){function o(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((c=c.apply(e,a||[])).next())})},E=function(r,o){var n,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=o.call(r,s)}catch(e){t=[6,e],i=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},S=(D(A,O=d),A.prototype.onPagingUpdated=function(e){this.paging=e,this.refresh()},A.prototype.buildSearchCriteria=function(){throw new Error("Implement buildSearchCriteria()")},A.prototype.buildResponseFormat=function(){throw new Error("Implement buildResponseFormat()")},A.prototype.performSearch=function(e,t){throw new Error("Implement performSearch()")},A.prototype.refresh=function(){return j(this,void 0,void 0,function(){var t,r,o;return E(this,function(e){switch(e.label){case 0:t=this.buildSearchCriteria(),r=this.buildResponseFormat(),this.paging&&(t.pageNumber=this.paging.pageNumber,t.pageSize=this.paging.pageSize),e.label=1;case 1:return e.trys.push([1,3,,4]),this.loaded=!1,[4,this.performSearch(t,r)];case 2:return o=e.sent(),this.results=o.data,this.matches=o.data.results,[3,4];case 3:return n(e.sent()),[3,4];case 4:return this.loaded=!0,[2]}})})},A=R([c],A));function A(){var e=null!==O&&O.apply(this,arguments)||this;return e.results=null,e.paging=null,e.matches=[],e.loaded=!1,e}var P,C=(D(M,P=d),M.prototype.getTokenParameter=function(){return"token"},M.prototype.created=function(){this.display(this.$route.params[this.getTokenParameter()])},M.prototype.beforeRouteUpdate=function(e,t,r){console.log("Route updated",e),this.display(e.params.token),r()},M.prototype.display=function(e){this.token=e,this.refresh()},M.prototype.loadRecord=function(e){throw new Error("Implement loadRecord()")},M.prototype.refresh=function(){return j(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.loaded=!1,[4,this.loadRecord(this.token)];case 1:return t=e.sent(),this.record=t.data,this.afterRecordLoaded(this.record),[3,3];case 2:return n(e.sent()),[3,3];case 3:return this.loaded=!0,[2]}})})},M.prototype.afterRecordLoaded=function(e){console.log("Loaded record",e)},M=R([c],M));function M(){var e=null!==P&&P.apply(this,arguments)||this;return e.token=null,e.record=null,e.loaded=!1,e}var k,L=(D($,k=d),$.prototype.formatDate=function(e){return r(e)},R([b(),_("design:type",Object)],$.prototype,"record",void 0),$=R([c],$));function $(){return null!==k&&k.apply(this,arguments)||this}var I,N=(D(T,I=d),T.prototype.reset=function(){throw new Error("Reset not implemented in dialog.")},T.prototype.load=function(e){throw new Error("Load not implemented in dialog.")},T.prototype.openDialog=function(){this.dialogVisible=!0},T.prototype.closeDialog=function(){this.dialogVisible=!1},T.prototype.showError=function(e){this.error=e},T.prototype.onCreateClicked=function(e){},T.prototype.onCancelClicked=function(e){this.closeDialog()},R([b(),_("design:type",String)],T.prototype,"title",void 0),R([b(),_("design:type",Number)],T.prototype,"width",void 0),R([b(),_("design:type",String)],T.prototype,"createLabel",void 0),R([b(),_("design:type",String)],T.prototype,"cancelLabel",void 0),R([b({default:!0}),_("design:type",Boolean)],T.prototype,"loaded",void 0),T=R([c],T));function T(){var e=null!==I&&I.apply(this,arguments)||this;return e.dialogVisible=!1,e.error=null,e}var F,U=(D(V,F=d),V.prototype.getDialog=function(){throw new Error("Create dialog must implement getDialog().")},V.prototype.open=function(){this.getDialog().reset(),this.getDialog().openDialog()},V.prototype.loadAndOpen=function(e){this.getDialog().reset(),this.getDialog().load(e),this.getDialog().openDialog()},V.prototype.save=function(e){throw new Error("Create dialog must implement save().")},V.prototype.afterSave=function(e){},V.prototype.isAxiosResponse=function(e){return void 0!==e.data},V.prototype.commit=function(o){return j(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.save(o)];case 1:return t=e.sent(),r=this.isAxiosResponse(t)?t.data:t,this.afterSave(r),this.$emit("created",r),this.getDialog().closeDialog(),[3,3];case 2:return n(e.sent()),[3,3];case 3:return[2]}})})},V);function V(){return null!==F&&F.apply(this,arguments)||this}var Y,q=(D(z,Y=d),z.prototype.getDialog=function(){throw new Error("Edit dialog must implement getDialog().")},z.prototype.prepareLoad=function(e){throw new Error("Edit dialog must implement load().")},z.prototype.isAxiosResponse=function(e){return void 0!==e.data},z.prototype.open=function(r){return j(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:this.getDialog().openDialog(),this.getDialog().reset(),this.loaded=!1,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.prepareLoad(r)];case 2:return t=e.sent(),this.record=this.isAxiosResponse(t)?t.data:t,this.getDialog().load(this.record),[3,4];case 3:return n(e.sent()),[3,4];case 4:return this.loaded=!0,[2]}})})},z.prototype.prepareSave=function(e,t){throw new Error("Edit dialog must implement save().")},z.prototype.save=function(o){return j(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:if(!this.record)throw new Error("Unable to update. Record is null.");e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.prepareSave(this.record,o)];case 2:return t=e.sent(),r=this.isAxiosResponse(t)?t.data:t,this.afterSave(r),this.$emit("updated",r),this.getDialog().closeDialog(),[3,4];case 3:return n(e.sent()),[3,4];case 4:return[2]}})})},z.prototype.afterSave=function(e){},z);function z(){var e=null!==Y&&Y.apply(this,arguments)||this;return e.record=null,e.loaded=!1,e}var B,H=(D(K,B=d),K.prototype.prepareLoad=function(e){throw new Error("Load not implemented in dialog.")},K.prototype.isAxiosResponse=function(e){return void 0!==e.data},K.prototype.afterLoad=function(e){},K.prototype.open=function(r){return j(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.prepareLoad(r)];case 1:return t=e.sent(),this.record=this.isAxiosResponse(t)?t.data:t,this.visible=!0,this.afterLoad(this.record),[3,3];case 2:return n(e.sent()),[3,3];case 3:return[2]}})})},K.prototype.prepareDelete=function(e){throw new Error("Delete not implemented in dialog.")},K.prototype.delete=function(){return j(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:if(!this.record)throw new Error("Unable to delete. Record is null.");e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.prepareDelete(this.record)];case 2:return t=e.sent(),this.record=this.isAxiosResponse(t)?t.data:t,this.$emit("deleted",this.record),this.closeDialog(),[3,4];case 3:return n(e.sent()),[3,4];case 4:return[2]}})})},K.prototype.cancel=function(){this.closeDialog()},K.prototype.closeDialog=function(){this.visible=!1},K.prototype.showError=function(e){this.error=e},R([b(),_("design:type",String)],K.prototype,"title",void 0),R([b(),_("design:type",Number)],K.prototype,"width",void 0),K=R([c],K));function K(){var e=null!==B&&B.apply(this,arguments)||this;return e.record=null,e.visible=!1,e.error=null,e}var W,G=(D(Z,W=d),Z.prototype.created=function(){this.reset()},Z.prototype.reset=function(){throw new Error("Reset not implemented in dialog section.")},Z.prototype.validate=function(){return!0},Z.prototype.load=function(e){},Z.prototype.save=function(){return{}},Z=R([c],Z));function Z(){return null!==W&&W.apply(this,arguments)||this}e.Vue=d,e.Component=c,e.CreateDialogComponent=U,e.DeleteDialogComponent=H,e.DetailComponent=C,e.DialogComponent=N,e.DialogSection=G,e.EditDialogComponent=q,e.Emit=function(c){return function(e,a,t){a=a.replace(w,"-$1").toLowerCase();var s=t.value;t.value=function(){for(var t=this,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];function o(e){void 0!==e&&r.unshift(e),t.$emit.apply(t,[c||a].concat(r))}var n,i=s.apply(this,r);return(n=i)instanceof Promise||n&&"function"==typeof n.then?i.then(function(e){o(e)}):o(i),i}}},e.HeaderComponent=L,e.Inject=function(r){return a(function(e,t){void 0===e.inject&&(e.inject={}),Array.isArray(e.inject)||(e.inject[t]=r||t)})},e.ListComponent=S,e.Mixins=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d.extend({mixins:t})},e.Model=function(r,o){return void 0===o&&(o={}),function(e,t){f(o,e,t),a(function(e,t){(e.props||(e.props={}))[t]=o,e.model={prop:t,event:r||t}})(e,t)}},e.Prop=b,e.Provide=function(n){return a(function(e,t){var r,o=e.provide;"function"==typeof(r=o)&&(r.managed||r.managedReactive)||(o=e.provide=p(o)),o.managed[t]=n||t})},e.Watch=function(o,e){void 0===e&&(e={});var t=e.deep,n=void 0!==t&&t,r=e.immediate,i=void 0!==r&&r;return a(function(e,t){"object"!=typeof e.watch&&(e.watch=Object.create(null));var r=e.watch;"object"!=typeof r[o]||Array.isArray(r[o])?void 0===r[o]&&(r[o]=[]):r[o]=[r[o]],r[o].push({handler:t,deep:n,immediate:i})})},e.arrayMove=function(e,t,r){for(;t<0;)t+=e.length;for(;r<0;)r+=e.length;if(r>=e.length)for(var o=r-e.length;1+o--;)e.push(void 0);return e.splice(r,0,e.splice(t,1)[0]),e},e.arrayToMetadata=function(e){var t={};if(e)for(var r=0;r<e.length;r++)t[e[r].name]=e[r].value;return t},e.ellipsis=function(e,t){return e.length>t?e.substring(0,t)+"...":e},e.formatDate=r,e.formatIso8601=function(e){return e?t(e).toISOString():null},e.fourDecimalPlaces=function(e){return Number(Math.round(parseFloat(e+"e4"))+"e-4").toFixed(4)},e.generateUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=crypto.getRandomValues(new Uint8Array(1))[0]%16|0;return("x"===e?t:3&t|8).toString(16)})},e.handleError=n,e.isAuthForAll=function(e,t){var r=e.$store.getters.user;return r?t.every(function(e){return-1<r.authorities.indexOf(e)}):(console.log("No user for permissions check."),!1)},e.isAxiosResponse=function(e){return void 0!==e.data},e.isBlank=function(e){return!e||/^\s*$/.test(e)},e.metadataToArray=function(e){var t=[];if(e)for(var r in e)e.hasOwnProperty(r)&&t.push({name:r,value:e[r]});return t},e.pagingForAllResults=function(){return"page=1&pageSize=0"},e.parseIso8601=function(e){return e?t(e).toDate():null},e.routeTo=o,e.routeToDevice=function(e,t){o(e,"/devices/"+t)},e.showError=function(e,t){var r={message:t,type:"error"};return e.$store.commit("message",r),r},e.showMessage=function(e,t){var r={message:t,type:"info"};return e.$store.commit("message",r),r},Object.defineProperty(e,"__esModule",{value:!0})});